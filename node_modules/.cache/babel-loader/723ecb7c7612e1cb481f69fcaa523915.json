{"ast":null,"code":"/* eslint-disable */\nimport React, { useRef, useState, useEffect, useImperativeHandle } from 'react';\nimport styled from 'styled-components';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar Wrapper = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n\"], [\"\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar Container = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  width: 100%;\\n  \", \"\\n\"], [\"\\n  width: 100%;\\n  \", \"\\n\"])), function (_a) {\n  var aspectRatio = _a.aspectRatio;\n  return aspectRatio === 'cover' ? \"\\n    position: absolute;\\n    bottom: 0;\\n    top: 0;\\n    left: 0;\\n    right: 0;\" : \"\\n    position: relative;\\n    padding-bottom: \" + 100 / aspectRatio + \"%;\";\n});\nvar ErrorMsg = styled.div(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  padding: 40px;\\n\"], [\"\\n  padding: 40px;\\n\"])));\nvar Cam = styled.video(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  z-index: 0;\\n  transform: rotateY(\", \");\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  z-index: 0;\\n  transform: rotateY(\", \");\\n\"])), function (_a) {\n  var mirrored = _a.mirrored;\n  return mirrored ? '180deg' : '0deg';\n});\nvar Canvas = styled.canvas(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  display: none;\\n\"], [\"\\n  display: none;\\n\"])));\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;\nvar Camera = React.forwardRef(function (_a, ref) {\n  var _b = _a.facingMode,\n      facingMode = _b === void 0 ? 'user' : _b,\n      _c = _a.aspectRatio,\n      aspectRatio = _c === void 0 ? 'cover' : _c,\n      _d = _a.numberOfCamerasCallback,\n      numberOfCamerasCallback = _d === void 0 ? function () {\n    return null;\n  } : _d,\n      _e = _a.errorMessages,\n      errorMessages = _e === void 0 ? {\n    noCameraAccessible: 'No camera device accessible. Please connect your camera or try a different browser.',\n    permissionDenied: 'Permission denied. Please refresh and give camera permission.',\n    switchCamera: 'It is not possible to switch camera to different one because there is only one video device accessible.',\n    canvas: 'Canvas is not supported.'\n  } : _e;\n  var player = useRef(null);\n  var canvas = useRef(null);\n  var container = useRef(null);\n\n  var _f = useState(0),\n      numberOfCameras = _f[0],\n      setNumberOfCameras = _f[1];\n\n  var _g = useState(null),\n      stream = _g[0],\n      setStream = _g[1];\n\n  var _h = useState(facingMode),\n      currentFacingMode = _h[0],\n      setFacingMode = _h[1];\n\n  var _j = useState(false),\n      notSupported = _j[0],\n      setNotSupported = _j[1];\n\n  var _k = useState(false),\n      permissionDenied = _k[0],\n      setPermissionDenied = _k[1];\n\n  useEffect(function () {\n    numberOfCamerasCallback(numberOfCameras);\n  }, [numberOfCameras]);\n  useImperativeHandle(ref, function () {\n    return {\n      takePhoto: function takePhoto() {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n\n        if (numberOfCameras < 1) {\n          throw new Error(errorMessages.noCameraAccessible);\n        }\n\n        if ((_a = canvas) === null || _a === void 0 ? void 0 : _a.current) {\n          var playerWidth = ((_c = (_b = player) === null || _b === void 0 ? void 0 : _b.current) === null || _c === void 0 ? void 0 : _c.videoWidth) || 1280;\n          var playerHeight = ((_e = (_d = player) === null || _d === void 0 ? void 0 : _d.current) === null || _e === void 0 ? void 0 : _e.videoHeight) || 720;\n          var playerAR = playerWidth / playerHeight;\n          var canvasWidth = ((_g = (_f = container) === null || _f === void 0 ? void 0 : _f.current) === null || _g === void 0 ? void 0 : _g.offsetWidth) || 1280;\n          var canvasHeight = ((_j = (_h = container) === null || _h === void 0 ? void 0 : _h.current) === null || _j === void 0 ? void 0 : _j.offsetHeight) || 1280;\n          var canvasAR = canvasWidth / canvasHeight;\n          var sX = void 0,\n              sY = void 0,\n              sW = void 0,\n              sH = void 0;\n\n          if (playerAR > canvasAR) {\n            sH = playerHeight;\n            sW = playerHeight * canvasAR;\n            sX = (playerWidth - sW) / 2;\n            sY = 0;\n          } else {\n            sW = playerWidth;\n            sH = playerWidth / canvasAR;\n            sX = 0;\n            sY = (playerHeight - sH) / 2;\n          }\n\n          canvas.current.width = sW;\n          canvas.current.height = sH;\n          var context = canvas.current.getContext('2d');\n\n          if (context && ((_k = player) === null || _k === void 0 ? void 0 : _k.current)) {\n            context.drawImage(player.current, sX, sY, sW, sH, 0, 0, sW, sH);\n          }\n\n          var imgData = canvas.current.toDataURL('image/jpeg');\n          return imgData;\n        } else {\n          throw new Error(errorMessages.canvas);\n        }\n      },\n      switchCamera: function switchCamera() {\n        if (numberOfCameras < 1) {\n          throw new Error(errorMessages.noCameraAccessible);\n        } else if (numberOfCameras < 2) {\n          console.error('Error: Unable to switch camera. Only one device is accessible.'); // console only\n        }\n\n        var newFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';\n        setFacingMode(newFacingMode);\n        return newFacingMode;\n      },\n      getNumberOfCameras: function getNumberOfCameras() {\n        return numberOfCameras;\n      }\n    };\n  });\n  useEffect(function () {\n    initCameraStream(stream, setStream, currentFacingMode, setNumberOfCameras, setNotSupported, setPermissionDenied);\n  }, [currentFacingMode]);\n  useEffect(function () {\n    if (stream && player && player.current) {\n      player.current.srcObject = stream;\n    }\n\n    return function () {\n      if (stream) {\n        stream.getTracks().forEach(function (track) {\n          track.stop();\n        });\n      }\n    };\n  }, [stream]);\n  return React.createElement(Container, {\n    ref: container,\n    aspectRatio: aspectRatio\n  }, React.createElement(Wrapper, null, notSupported ? React.createElement(ErrorMsg, null, errorMessages.noCameraAccessible) : null, permissionDenied ? React.createElement(ErrorMsg, null, errorMessages.permissionDenied) : null, React.createElement(Cam, {\n    ref: player,\n    id: \"video\",\n    muted: true,\n    autoPlay: true,\n    playsInline: true,\n    mirrored: currentFacingMode === 'user' ? true : false\n  }), React.createElement(Canvas, {\n    ref: canvas\n  })));\n});\nCamera.displayName = 'Camera';\n\nvar initCameraStream = function initCameraStream(stream, setStream, currentFacingMode, setNumberOfCameras, setNotSupported, setPermissionDenied) {\n  var _a, _b; // stop any active streams in the window\n\n\n  if (stream) {\n    stream.getTracks().forEach(function (track) {\n      track.stop();\n    });\n  }\n\n  var constraints = {\n    audio: false,\n    video: {\n      facingMode: currentFacingMode,\n      width: {\n        ideal: 1920\n      },\n      height: {\n        ideal: 1920\n      }\n    }\n  };\n\n  if ((_b = (_a = navigator) === null || _a === void 0 ? void 0 : _a.mediaDevices) === null || _b === void 0 ? void 0 : _b.getUserMedia) {\n    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n      setStream(handleSuccess(stream, setNumberOfCameras));\n    }).catch(function (err) {\n      handleError(err, setNotSupported, setPermissionDenied);\n    });\n  } else {\n    var getWebcam = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\n    if (getWebcam) {\n      getWebcam(constraints, function (stream) {\n        setStream(handleSuccess(stream, setNumberOfCameras));\n      }, function (err) {\n        handleError(err, setNotSupported, setPermissionDenied);\n      });\n    } else {\n      setNotSupported(true);\n    }\n  }\n};\n\nvar handleSuccess = function handleSuccess(stream, setNumberOfCameras) {\n  navigator.mediaDevices.enumerateDevices().then(function (r) {\n    return setNumberOfCameras(r.filter(function (i) {\n      return i.kind === 'videoinput';\n    }).length);\n  });\n  return stream;\n};\n\nvar handleError = function handleError(error, setNotSupported, setPermissionDenied) {\n  console.error(error); //https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n\n  if (error.name === 'PermissionDeniedError') {\n    setPermissionDenied(true);\n  } else {\n    setNotSupported(true);\n  }\n};\n\nexport { Camera };","map":{"version":3,"sources":["/Users/tjmcrill/Documents/ForceForGood/react-camera-pro/example/src/Camera/index.js"],"names":["React","useRef","useState","useEffect","useImperativeHandle","styled","__makeTemplateObject","cooked","raw","Object","defineProperty","value","Wrapper","div","templateObject_1","Container","templateObject_2","_a","aspectRatio","ErrorMsg","templateObject_3","Cam","video","templateObject_4","mirrored","Canvas","canvas","templateObject_5","Camera","forwardRef","ref","_b","facingMode","_c","_d","numberOfCamerasCallback","_e","errorMessages","noCameraAccessible","permissionDenied","switchCamera","player","container","_f","numberOfCameras","setNumberOfCameras","_g","stream","setStream","_h","currentFacingMode","setFacingMode","_j","notSupported","setNotSupported","_k","setPermissionDenied","takePhoto","Error","current","playerWidth","videoWidth","playerHeight","videoHeight","playerAR","canvasWidth","offsetWidth","canvasHeight","offsetHeight","canvasAR","sX","sY","sW","sH","width","height","context","getContext","drawImage","imgData","toDataURL","console","error","newFacingMode","getNumberOfCameras","initCameraStream","srcObject","getTracks","forEach","track","stop","createElement","id","muted","autoPlay","playsInline","displayName","constraints","audio","ideal","navigator","mediaDevices","getUserMedia","then","handleSuccess","catch","err","handleError","getWebcam","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","enumerateDevices","r","filter","i","kind","length","name"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, { useRef, useState, useEffect, useImperativeHandle } from 'react';\nimport styled from 'styled-components';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n}\n\nvar Wrapper = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n\"], [\"\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n\"])));\r\nvar Container = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  width: 100%;\\n  \", \"\\n\"], [\"\\n  width: 100%;\\n  \",\r\n    \"\\n\"])), function (_a) {\r\n    var aspectRatio = _a.aspectRatio;\r\n    return aspectRatio === 'cover'\r\n        ? \"\\n    position: absolute;\\n    bottom: 0;\\n    top: 0;\\n    left: 0;\\n    right: 0;\"\r\n        : \"\\n    position: relative;\\n    padding-bottom: \" + 100 / aspectRatio + \"%;\";\r\n});\r\nvar ErrorMsg = styled.div(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  padding: 40px;\\n\"], [\"\\n  padding: 40px;\\n\"])));\r\nvar Cam = styled.video(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  z-index: 0;\\n  transform: rotateY(\", \");\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  z-index: 0;\\n  transform: rotateY(\", \");\\n\"])), function (_a) {\r\n    var mirrored = _a.mirrored;\r\n    return (mirrored ? '180deg' : '0deg');\r\n});\r\nvar Canvas = styled.canvas(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  display: none;\\n\"], [\"\\n  display: none;\\n\"])));\r\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;\n\nvar Camera = React.forwardRef(function (_a, ref) {\r\n    var _b = _a.facingMode, facingMode = _b === void 0 ? 'user' : _b, _c = _a.aspectRatio, aspectRatio = _c === void 0 ? 'cover' : _c, _d = _a.numberOfCamerasCallback, numberOfCamerasCallback = _d === void 0 ? function () { return null; } : _d, _e = _a.errorMessages, errorMessages = _e === void 0 ? {\r\n        noCameraAccessible: 'No camera device accessible. Please connect your camera or try a different browser.',\r\n        permissionDenied: 'Permission denied. Please refresh and give camera permission.',\r\n        switchCamera: 'It is not possible to switch camera to different one because there is only one video device accessible.',\r\n        canvas: 'Canvas is not supported.',\r\n    } : _e;\r\n    var player = useRef(null);\r\n    var canvas = useRef(null);\r\n    var container = useRef(null);\r\n    var _f = useState(0), numberOfCameras = _f[0], setNumberOfCameras = _f[1];\r\n    var _g = useState(null), stream = _g[0], setStream = _g[1];\r\n    var _h = useState(facingMode), currentFacingMode = _h[0], setFacingMode = _h[1];\r\n    var _j = useState(false), notSupported = _j[0], setNotSupported = _j[1];\r\n    var _k = useState(false), permissionDenied = _k[0], setPermissionDenied = _k[1];\r\n    useEffect(function () {\r\n        numberOfCamerasCallback(numberOfCameras);\r\n    }, [numberOfCameras]);\r\n    useImperativeHandle(ref, function () { return ({\r\n        takePhoto: function () {\r\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n            if (numberOfCameras < 1) {\r\n                throw new Error(errorMessages.noCameraAccessible);\r\n            }\r\n            if ((_a = canvas) === null || _a === void 0 ? void 0 : _a.current) {\r\n                var playerWidth = ((_c = (_b = player) === null || _b === void 0 ? void 0 : _b.current) === null || _c === void 0 ? void 0 : _c.videoWidth) || 1280;\r\n                var playerHeight = ((_e = (_d = player) === null || _d === void 0 ? void 0 : _d.current) === null || _e === void 0 ? void 0 : _e.videoHeight) || 720;\r\n                var playerAR = playerWidth / playerHeight;\r\n                var canvasWidth = ((_g = (_f = container) === null || _f === void 0 ? void 0 : _f.current) === null || _g === void 0 ? void 0 : _g.offsetWidth) || 1280;\r\n                var canvasHeight = ((_j = (_h = container) === null || _h === void 0 ? void 0 : _h.current) === null || _j === void 0 ? void 0 : _j.offsetHeight) || 1280;\r\n                var canvasAR = canvasWidth / canvasHeight;\r\n                var sX = void 0, sY = void 0, sW = void 0, sH = void 0;\r\n                if (playerAR > canvasAR) {\r\n                    sH = playerHeight;\r\n                    sW = playerHeight * canvasAR;\r\n                    sX = (playerWidth - sW) / 2;\r\n                    sY = 0;\r\n                }\r\n                else {\r\n                    sW = playerWidth;\r\n                    sH = playerWidth / canvasAR;\r\n                    sX = 0;\r\n                    sY = (playerHeight - sH) / 2;\r\n                }\r\n                canvas.current.width = sW;\r\n                canvas.current.height = sH;\r\n                var context = canvas.current.getContext('2d');\r\n                if (context && ((_k = player) === null || _k === void 0 ? void 0 : _k.current)) {\r\n                    context.drawImage(player.current, sX, sY, sW, sH, 0, 0, sW, sH);\r\n                }\r\n                var imgData = canvas.current.toDataURL('image/jpeg');\r\n                return imgData;\r\n            }\r\n            else {\r\n                throw new Error(errorMessages.canvas);\r\n            }\r\n        },\r\n        switchCamera: function () {\r\n            if (numberOfCameras < 1) {\r\n                throw new Error(errorMessages.noCameraAccessible);\r\n            }\r\n            else if (numberOfCameras < 2) {\r\n                console.error('Error: Unable to switch camera. Only one device is accessible.'); // console only\r\n            }\r\n            var newFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';\r\n            setFacingMode(newFacingMode);\r\n            return newFacingMode;\r\n        },\r\n        getNumberOfCameras: function () {\r\n            return numberOfCameras;\r\n        },\r\n    }); });\r\n    useEffect(function () {\r\n        initCameraStream(stream, setStream, currentFacingMode, setNumberOfCameras, setNotSupported, setPermissionDenied);\r\n    }, [currentFacingMode]);\r\n    useEffect(function () {\r\n        if (stream && player && player.current) {\r\n            player.current.srcObject = stream;\r\n        }\r\n        return function () {\r\n            if (stream) {\r\n                stream.getTracks().forEach(function (track) {\r\n                    track.stop();\r\n                });\r\n            }\r\n        };\r\n    }, [stream]);\r\n    return (React.createElement(Container, { ref: container, aspectRatio: aspectRatio },\r\n        React.createElement(Wrapper, null,\r\n            notSupported ? React.createElement(ErrorMsg, null, errorMessages.noCameraAccessible) : null,\r\n            permissionDenied ? React.createElement(ErrorMsg, null, errorMessages.permissionDenied) : null,\r\n            React.createElement(Cam, { ref: player, id: \"video\", muted: true, autoPlay: true, playsInline: true, mirrored: currentFacingMode === 'user' ? true : false }),\r\n            React.createElement(Canvas, { ref: canvas }))));\r\n});\r\nCamera.displayName = 'Camera';\r\nvar initCameraStream = function (stream, setStream, currentFacingMode, setNumberOfCameras, setNotSupported, setPermissionDenied) {\r\n    var _a, _b;\r\n    // stop any active streams in the window\r\n    if (stream) {\r\n        stream.getTracks().forEach(function (track) {\r\n            track.stop();\r\n        });\r\n    }\r\n    var constraints = {\r\n        audio: false,\r\n        video: {\r\n            facingMode: currentFacingMode,\r\n            width: { ideal: 1920 },\r\n            height: { ideal: 1920 },\r\n        },\r\n    };\r\n    if ((_b = (_a = navigator) === null || _a === void 0 ? void 0 : _a.mediaDevices) === null || _b === void 0 ? void 0 : _b.getUserMedia) {\r\n        navigator.mediaDevices\r\n            .getUserMedia(constraints)\r\n            .then(function (stream) {\r\n            setStream(handleSuccess(stream, setNumberOfCameras));\r\n        })\r\n            .catch(function (err) {\r\n            handleError(err, setNotSupported, setPermissionDenied);\r\n        });\r\n    }\r\n    else {\r\n        var getWebcam = navigator.getUserMedia ||\r\n            navigator.webkitGetUserMedia ||\r\n            navigator.mozGetUserMedia ||\r\n            navigator.mozGetUserMedia ||\r\n            navigator.msGetUserMedia;\r\n        if (getWebcam) {\r\n            getWebcam(constraints, function (stream) {\r\n                setStream(handleSuccess(stream, setNumberOfCameras));\r\n            }, function (err) {\r\n                handleError(err, setNotSupported, setPermissionDenied);\r\n            });\r\n        }\r\n        else {\r\n            setNotSupported(true);\r\n        }\r\n    }\r\n};\r\nvar handleSuccess = function (stream, setNumberOfCameras) {\r\n    navigator.mediaDevices\r\n        .enumerateDevices()\r\n        .then(function (r) { return setNumberOfCameras(r.filter(function (i) { return i.kind === 'videoinput'; }).length); });\r\n    return stream;\r\n};\r\nvar handleError = function (error, setNotSupported, setPermissionDenied) {\r\n    console.error(error);\r\n    //https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\r\n    if (error.name === 'PermissionDeniedError') {\r\n        setPermissionDenied(true);\r\n    }\r\n    else {\r\n        setNotSupported(true);\r\n    }\r\n};\n\nexport { Camera };\n"]},"metadata":{},"sourceType":"module"}